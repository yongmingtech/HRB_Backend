*** Setting ***
Test Setup        Click Code Maintain Button
Test Teardown     Close All Browsers
Resource          ../Login.robot
Resource          ../DataBase.robot
Resource          DB_Query.txt

*** Variables ***
${Menu_Code_Type_ID}    ext-gen1240
${Code_MainTain_Button}    ${EMPTY}
${Code_MainTain_Button_ID}    id=button-1014-btnEl

*** Test Cases ***
Code type sort by ascend
    [Documentation]    Test case Description :
    ...    主要測試代碼查詢下面的代碼類型下拉式選單
    ...    1. 使用者點擊左上角代碼維護
    ...    2. 在代碼查詢下有一個下拉選單叫做代碼類型
    ...    3. 抓出資料庫資料
    ...    4. 資料庫資料要和代碼類型選單比較
    ...
    ...    Verify :
    ...    代碼類型下拉選單筆數要和資料庫比數符合
    Wait Until Element Is Visible    ${Menu_Code_Type_ID}    ${G_Wait_For_Element_Timeout}
    Click Element    ${Menu_Code_Type_ID}
    Connect Database
    ${queryResults}    Query    ${Query_Code_Type}
    Log Many    ${queryResults}
    ${Code Type List Count}=    Get Matching Xpath Count    xpath=//*[@id="boundlist-1143-listEl"]/div
    ${Code Type List Count}=    Evaluate    ${Code Type List Count}-1
    Length Should Be    ${queryResults}    ${Code Type List Count}

Code Type Pop up Window
    [Documentation]    Test case Description :
    ...    主要測試代碼查詢下面Gridview，滑鼠點擊其中一筆資料，跳窗出來的資訊是否正確
    ...    1. 使用者點擊左上角代碼維護
    ...    2. 點擊GridView其中一筆資料
    ...    3. 跳出"代碼類型維護"視窗
    ...
    ...    Verify :
    ...    代碼類型和代碼名稱要和跳窗出來的代碼類型和代碼名稱符合
    Sleep    5
    Double Click Element    id=gridview-1096-record-c628fed5-695c-45c8-8a3f-d39d9a8b18dd
    ${CodeType}=    Get Text    xpath=//*[@id="gridview-1096-record-c628fed5-695c-45c8-8a3f-d39d9a8b18dd"]/td[5]/div
    ${CodeTypeName}=    Get Text    xpath=//*[@id="gridview-1096-record-c628fed5-695c-45c8-8a3f-d39d9a8b18dd"]/td[6]/div
    Sleep    2
    ${CodeTypePopup}    Get Text    id=displayfield-1147-inputEl
    ${CodeTypeNamePopup}    Get Value    id=textfield-1148-inputEl
    ${CodeTypeDescriptionPopup}    Get Value    id=textareafield-1149-inputEl
    Connect Database
    ${queryResults}    Query    ${Query Code Type Description}
    ${GetData}=    Convert To String    ${queryResults[0]}
    ${DescriptionList}=    Split String    ${GetData}    '    2
    ${Description}=    Convert To String    ${DescriptionList[1]}
    ${Description}=    Strip String    ${Description}
    Log    ${CodeType}
    Log    ${CodeTypeName}
    Log    ${Description}
    Log    ${CodeTypePopup}
    Log    ${CodeTypeNamePopup}
    Log    ${CodeTypeDescriptionPopup}
    Should Be Equal    ${CodeType}    ${CodeTypePopup}
    Should Be Equal    ${CodeTypeName}    ${CodeTypeNamePopup}
    Should Be Equal    ${Description}    ${CodeTypeDescriptionPopup}
    Sleep    1

*** Keywords ***
Click Code Maintain Button
    Open Broser and Login automatically
    Sleep    5
    ${Code_MainTain_Button}=    Set Variable    ${Code_MainTain_Button_ID}
    Wait Until Element Is Visible    ${Code_MainTain_Button}    ${G_Wait_For_Element_Timeout}
    Mouse Over    ${Code MainTain Button}
    Wait Until Element Is Visible    ${Code_MainTain_Button}    ${G_Wait_For_Element_Timeout}
    Click Element    ${Code_MainTain_Button}
